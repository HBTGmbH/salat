<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}"
      th:with="section='orders',subSection='reports',title='Reports',sectionTitle=#{main.general.mainmenu.orders.text}">
<main layout:fragment="content">

  <div th:replace="~{fragments/master-table :: masterTableFilter(
      addHref=@{'/reporting/reports/create'(filter=${filter})}, addLabel=${'New Report'},
      thead=~{::theadContent}, tbody=~{::tbodyContent},
      addIf=${#authorization.expression('hasRole(''MANAGER'')')},
      addIcon='ti-file-plus',
      filterHref=@{/reporting/reports},
      filterValue=${filter}
    )}">

    <thead th:fragment="theadContent">
      <tr>
        <th th:replace="~{fragments/master-table :: colHeaderPrimary(label=${'Name'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Last Updated'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Last Updated By'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeaderActionIcon()}"></th>
        <th th:replace="~{fragments/master-table :: colHeaderActionIcon()}"></th>
        <th th:replace="~{fragments/master-table :: colHeaderActionIcon()}"></th>
      </tr>
    </thead>

    <tbody th:fragment="tbodyContent">
      <tr th:each="report : ${reports}">
        <td th:replace="~{fragments/master-table :: colTextPrimary(text=${report.name})}"></td>
        <td th:replace="~{fragments/master-table :: colDate(date=${report.lastupdate})}" class="d-none d-sm-table-cell"></td>
        <td th:replace="~{fragments/master-table :: colText(text=${report.lastupdatedby})}" class="d-none d-sm-table-cell"></td>
        <td>
          <a class="btn btn-success" th:href="@{'/reporting/reports/execute'(id=${report.id}, filter=${filter})}"><i class="icon ti ti-player-play" style="margin-right: 0; margin-left: 0"></i></a>
        </td>
        <td th:replace="~{fragments/master-table :: colEditLinkIf(href=@{'/reporting/reports/edit'(id=${report.id}, filter=${filter})}, ifCondition=mayEdit[report.id])}"></td>
        <td th:replace="~{fragments/master-table :: colDeleteFormIf(id=${report.id}, action=@{'/reporting/reports/delete'}, ifCondition=mayDelete[report.id])}"></td>
      </tr>
    </tbody>

  </div>

</main>
</html>
