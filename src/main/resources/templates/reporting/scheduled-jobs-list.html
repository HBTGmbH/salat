<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}"
      th:with="section='orders',subSection='scheduled-report-jobs',title='Scheduled Report Jobs',sectionTitle=#{main.general.mainmenu.orders.text}">
<main layout:fragment="content">

  <div th:replace="~{fragments/master-table :: masterTable(
      addHref=@{/reporting/jobs/create}, addLabel=${'Schedule Report'},
      thead=~{::theadContent}, tbody=~{::tbodyContent},
      addIf=${true},
      addIcon='ti-clock-plus'
    )}">

    <thead th:fragment="theadContent">
      <tr>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Name'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Report'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Recipients'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Enabled'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Schedule'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeader(label=${'Last Updated'})}"></th>
        <th th:replace="~{fragments/master-table :: colHeaderNarrow()}"></th>
        <th th:replace="~{fragments/master-table :: colHeaderNarrow()}"></th>
      </tr>
    </thead>

    <tbody th:fragment="tbodyContent">
      <tr th:each="job : ${jobs}">
        <td th:replace="~{fragments/master-table :: colText(text=${job.name})}"></td>
        <td th:replace="~{fragments/master-table :: colText(text=${job.reportDefinition != null ? job.reportDefinition.name : '—'})}"></td>
        <td th:replace="~{fragments/master-table :: colText(text=${job.recipientEmails})}"></td>
        <td th:replace="~{fragments/master-table :: colYesNo(enabled=${job.enabled})}"></td>
        <td th:replace="~{fragments/master-table :: colTextAdd(text=${#strings.isEmpty(job.cronExpression) ? defaultCron : job.cronExpression}, additional=${cronDescriptions[job.id]})}"></td>
        <td th:replace="~{fragments/master-table :: colDate(date=${job.lastupdate})}"></td>
        <td th:replace="~{fragments/master-table :: colEditLink(href=@{'/reporting/jobs/edit'(id=${job.id})})}"></td>
        <td th:replace="~{fragments/master-table :: colDeleteForm(id=${job.id}, action=@{'/reporting/jobs/delete'})}"></td>
      </tr>
    </tbody>

  </div>

</main>
</html>
