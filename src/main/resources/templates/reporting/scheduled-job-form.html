<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}"
      th:with="section='orders',subSection='scheduled-report-jobs',title=${pageTitle},sectionTitle=#{main.general.mainmenu.orders.text}">
<main layout:fragment="content">
  <div class="card">
    <div class="card-body">
      <form th:action="@{/reporting/jobs/store}" th:object="${job}" method="post">

        <input type="hidden" th:field="*{id}" />

        <div th:replace="~{fragments/form-fields :: textInput(
          field='name', label='Job Name', required=true, maxlength=255
        )}"></div>

        <div th:replace="~{fragments/form-fields :: selectInput(
          field='reportDefinitionId', label='Report', required=true,
          placeholder='-- Select Report --', options=${reportDefinitions},
          optionValue='id', optionLabel='name'
        )}"></div>

        <div th:replace="~{fragments/form-fields :: textareaInputHelp(
          field='reportParameters', label='Report Parameters (JSON)', required=false,
          rows=5, helpText=${'Example: {&quot;startDate&quot;: &quot;2024-01-01&quot;, &quot;endDate&quot;: &quot;2024-12-31&quot;}'}, monospace=true
        )}"></div>

        <div th:replace="~{fragments/form-fields :: textareaInputHelp(
          field='recipientEmails', label='Recipient Emails', required=true,
          rows=3, helpText='Comma or semicolon separated email addresses', monospace=false
        )}"></div>

        <div th:replace="~{fragments/form-fields :: checkboxSwitch(
          field='enabled', label='Enabled'
        )}"></div>

        <div th:replace="~{fragments/form-fields :: textInputHelp(
          field='cronExpression', label='Cron Expression (optional)', required=false,
          maxlength=255, helpText='Leave empty for default schedule (Daily at 5:00 AM)'
        )}"></div>

        <div th:replace="~{fragments/form-fields :: textareaInput(
          field='description', label='Description', required=false, rows=3, monospace=false
        )}"></div>

        <div th:replace="~{fragments/form-fields :: formButtons(
          saveLabel='Save Scheduled Job', cancelHref=@{/reporting/jobs}
        )}"></div>

      </form>
    </div>
  </div>
</main>
</html>
